<!DOCTYPE HTML>
<html>

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,Chrome=1" />
  <title>JS-Piano</title>
  <!-- Public -->
  <script src="./Public/jquery-3.6.0.js"></script>
  <script src="./Public/vue.js"></script>
  <link rel="stylesheet" href="./Public/component.css">
  <link rel="stylesheet" href="./Public/blue-component.css">
  <script src="./Public/layer/layer.js"></script>
  <script src="./Public/JS-Piano.js"></script>
  <!-- Music_G -->
  <script src="./Music_G/su.js"></script>
  <style>
    * {
      font-family: Consolas;
      transition: all .16s;
    }
    
    .PianoBlock {
      /* 防止用户误选 */
      user-select: none;
    }
    
    .Ver8 {
      border: #ddd 1px solid;
      border-top: none;
      border-bottom: none;
    }
    
    .Ver88 {
      border: #ddd 1px solid;
      border-top: none;
    }
    
    .whiteKey {
      font-size: 13px;
      box-sizing: border-box;
      background: white;
      color: #888;
      width: 100%;
      height: 24px;
      line-height: 24px;
      text-align: right;
      padding-right: 5px;
      border-top: #ddd 1px solid;
    }
    
    .WKActive {
      background: coral!important;
    }
    
    .blackKey {
      font-size: 11px;
      box-sizing: border-box;
      background: #333;
      color: #ccc;
      width: 70%;
      height: 16px;
      line-height: 15px;
      text-align: right;
      padding-right: 5px;
      border: #ddd 1px solid;
      border-left: none;
      position: absolute;
      left: 0;
      transform: translate(0, -50%);
    }
    
    .BKActive {
      background: lightskyblue;
    }
  </style>
</head>

<body>
  <div id="app">

    <div class="PianoBlock">
      <div class="Ver8 bc-flex bc-flex-d-c bc-flex-jc-c bc-flex-ai-s bc-t-999 bc-f-13rp ps-r" style="width:90px;">
        <div scale="88" class="piano-key whiteKey">C</div>
      </div>
      <div class="Ver8 bc-flex bc-flex-d-c bc-flex-jc-c bc-flex-ai-s bc-t-999 bc-f-13rp ps-r" style="width:90px;">
        <div scale="87" class="piano-key whiteKey">B</div>
        <div scale="86" class="piano-key blackKey" style="top:24px;">A#</div>
        <div scale="85" class="piano-key whiteKey">A</div>
        <div scale="84" class="piano-key blackKey" style="top:48px;">G#</div>
        <div scale="83" class="piano-key whiteKey">G</div>
        <div scale="82" class="piano-key blackKey" style="top:72px;">F#</div>
        <div scale="81" class="piano-key whiteKey">F</div>
        <div scale="80" class="piano-key whiteKey">E</div>
        <div scale="79" class="piano-key blackKey" style="top:120px;">D#</div>
        <div scale="78" class="piano-key whiteKey">D</div>
        <div scale="77" class="piano-key blackKey" style="top:144px;">C#</div>
        <div scale="76" class="piano-key whiteKey">C</div>
      </div>
      <div class="Ver8 bc-flex bc-flex-d-c bc-flex-jc-c bc-flex-ai-s bc-t-999 bc-f-13rp ps-r" style="width:90px;">
        <div scale="75" class="piano-key whiteKey">B</div>
        <div scale="74" class="piano-key blackKey" style="top:24px;">A#</div>
        <div scale="73" class="piano-key whiteKey">A</div>
        <div scale="72" class="piano-key blackKey" style="top:48px;">G#</div>
        <div scale="71" class="piano-key whiteKey">G</div>
        <div scale="70" class="piano-key blackKey" style="top:72px;">F#</div>
        <div scale="69" class="piano-key whiteKey">F</div>
        <div scale="68" class="piano-key whiteKey">E</div>
        <div scale="67" class="piano-key blackKey" style="top:120px;">D#</div>
        <div scale="66" class="piano-key whiteKey">D</div>
        <div scale="65" class="piano-key blackKey" style="top:144px;">C#</div>
        <div scale="64" class="piano-key whiteKey">C</div>
      </div>
      <div class="Ver8 bc-flex bc-flex-d-c bc-flex-jc-c bc-flex-ai-s bc-t-999 bc-f-13rp ps-r" style="width:90px;">
        <div scale="63" class="piano-key whiteKey">B</div>
        <div scale="62" class="piano-key blackKey" style="top:24px;">A#</div>
        <div scale="61" class="piano-key whiteKey">A</div>
        <div scale="60" class="piano-key blackKey" style="top:48px;">G#</div>
        <div scale="59" class="piano-key whiteKey">G</div>
        <div scale="58" class="piano-key blackKey" style="top:72px;">F#</div>
        <div scale="57" class="piano-key whiteKey">F</div>
        <div scale="56" class="piano-key whiteKey">E</div>
        <div scale="55" class="piano-key blackKey" style="top:120px;">D#</div>
        <div scale="54" class="piano-key whiteKey">D</div>
        <div scale="53" class="piano-key blackKey" style="top:144px;">C#</div>
        <div scale="52" class="piano-key whiteKey">C</div>
      </div>
      <div class="Ver8 bc-flex bc-flex-d-c bc-flex-jc-c bc-flex-ai-s bc-t-999 bc-f-13rp ps-r" style="width:90px;">
        <div scale="51" class="piano-key whiteKey">B</div>
        <div scale="50" class="piano-key blackKey" style="top:24px;">A#</div>
        <div scale="49" class="piano-key whiteKey">A</div>
        <div scale="48" class="piano-key blackKey" style="top:48px;">G#</div>
        <div scale="47" class="piano-key whiteKey">G</div>
        <div scale="46" class="piano-key blackKey" style="top:72px;">F#</div>
        <div scale="45" class="piano-key whiteKey">F</div>
        <div scale="44" class="piano-key whiteKey">E</div>
        <div scale="43" class="piano-key blackKey" style="top:120px;">D#</div>
        <div scale="42" class="piano-key whiteKey">D</div>
        <div scale="41" class="piano-key blackKey" style="top:144px;">C#</div>
        <div scale="40" class="piano-key whiteKey">C</div>
      </div>
      <div class="Ver8 bc-flex bc-flex-d-c bc-flex-jc-c bc-flex-ai-s bc-t-999 bc-f-13rp ps-r" style="width:90px;">
        <div scale="39" class="piano-key whiteKey">B</div>
        <div scale="38" class="piano-key blackKey" style="top:24px;">A#</div>
        <div scale="37" class="piano-key whiteKey">A</div>
        <div scale="36" class="piano-key blackKey" style="top:48px;">G#</div>
        <div scale="35" class="piano-key whiteKey">G</div>
        <div scale="34" class="piano-key blackKey" style="top:72px;">F#</div>
        <div scale="33" class="piano-key whiteKey">F</div>
        <div scale="32" class="piano-key whiteKey">E</div>
        <div scale="31" class="piano-key blackKey" style="top:120px;">D#</div>
        <div scale="30" class="piano-key whiteKey">D</div>
        <div scale="29" class="piano-key blackKey" style="top:144px;">C#</div>
        <div scale="28" class="piano-key whiteKey">C</div>
      </div>
      <div class="Ver8 bc-flex bc-flex-d-c bc-flex-jc-c bc-flex-ai-s bc-t-999 bc-f-13rp ps-r" style="width:90px;">
        <div scale="27" class="piano-key whiteKey">B</div>
        <div scale="26" class="piano-key blackKey" style="top:24px;">A#</div>
        <div scale="25" class="piano-key whiteKey">A</div>
        <div scale="24" class="piano-key blackKey" style="top:48px;">G#</div>
        <div scale="23" class="piano-key whiteKey">G</div>
        <div scale="22" class="piano-key blackKey" style="top:72px;">F#</div>
        <div scale="21" class="piano-key whiteKey">F</div>
        <div scale="20" class="piano-key whiteKey">E</div>
        <div scale="19" class="piano-key blackKey" style="top:120px;">D#</div>
        <div scale="18" class="piano-key whiteKey">D</div>
        <div scale="17" class="piano-key blackKey" style="top:144px;">C#</div>
        <div scale="16" class="piano-key whiteKey">C</div>
      </div>
      <div class="Ver8 bc-flex bc-flex-d-c bc-flex-jc-c bc-flex-ai-s bc-t-999 bc-f-13rp ps-r" style="width:90px;">
        <div scale="15" class="piano-key whiteKey">B</div>
        <div scale="14" class="piano-key blackKey" style="top:24px;">A#</div>
        <div scale="13" class="piano-key whiteKey">A</div>
        <div scale="12" class="piano-key blackKey" style="top:48px;">G#</div>
        <div scale="11" class="piano-key whiteKey">G</div>
        <div scale="10" class="piano-key blackKey" style="top:72px;">F#</div>
        <div scale="9" class="piano-key whiteKey">F</div>
        <div scale="8" class="piano-key whiteKey">E</div>
        <div scale="7" class="piano-key blackKey" style="top:120px;">D#</div>
        <div scale="6" class="piano-key whiteKey">D</div>
        <div scale="5" class="piano-key blackKey" style="top:144px;">C#</div>
        <div scale="4" class="piano-key whiteKey">C</div>
      </div>
      <div class="Ver88 bc-flex bc-flex-d-c bc-flex-jc-c bc-flex-ai-s bc-t-999 bc-f-13rp ps-r" style="width:90px;">
        <div scale="3" class="piano-key whiteKey">B</div>
        <div scale="2" class="piano-key blackKey" style="top:24px;">A#</div>
        <div scale="1" class="piano-key whiteKey">A</div>
      </div>
    </div>

  </div>

  <script>
    var vm = new Vue({
      el: "#app",
      data: {}
    })

    // 播放控制 Music
    var Music = Su;

    // title 初始化
    if (Music == Su) {
      document.title = "溯"
    } else if (Music != Su) {
      document.title = "Piano.js"
    }

    var isClick = false;
    // 按键判定前置
    $(window).mousedown(function() {
      isClick = true;
    });
    $(window).mouseup(function() {
      isClick = false;
      cleanAct();
    });
    $(".piano-key").mouseout(function() {
      cleanAct();
    });
    // 按键判定
    $(".piano-key").mouseover(function() {
      if (isClick) {
        Playing($(this));
      }
    });

    // 琴键音效即触发效果
    function Playing(ele) {
      if (ele.hasClass("whiteKey")) {
        ele.addClass("WKActive");
      } else {
        ele.addClass("BKActive");
      }
      var pianoKey = new Audio("res/" + ele.attr("scale") + ".mp3");
      pianoKey.preload = "auto";
      pianoKey.currentTime = 0;
      pianoKey.volume = 0.2;
      pianoKey.play();
    }

    var NavView;
    // 页面加载播放
    window.onload = function() {
      pianist();
      if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
        // console.log("Wap");
        NavView = "wap";
        // "..."为spread运算符，ES6语法
        [...document.querySelectorAll('.piano-key')].forEach(function(item) {
          item.addEventListener('touchstart', function() {
            Playing($(this));
          });
        });
      } else {
        // console.log("Pc");
        NavView = "pc";
        $(".piano-key").mousedown(function() {
          Playing($(this));
        });
      }
    }
    var KeyboardVol = 0.3;
  </script>
</body>

</html>